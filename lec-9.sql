CREATE DATABASE ORG;
SHOW DATABASES;
USE ORG;
CREATE TABLE workers(
	WORKER_ID INT NOT NULL PRIMARY KEY auto_increment,
	FIRST_NAME CHAR(25),
	LAST_NAME CHAR(25),
	SALARY INT(15),
	JOINING_DATE DATETIME,
	DEPARTMENT CHAR(25)
);
INSERT INTO workers
(WORKER_ID, FIRST_NAME, LAST_NAME, SALARY, JOINING_DATE, DEPARTMENT) VALUES
(001, "Monika", "Arora", 100000, '14-02-20 09.00.00', 'HR'),
(002, 'Niharika', 'Verma', 80000, '14-06-11 09.00.00.','Admin'),
(003, 'Vishal', "Singhal", 300000, '14-02-20 09.00.00', 'HR'),
(004, 'Amitabh', 'Singh', 500000, '14-02-20 09.00.00', 'Admin'),
(005, 'Vivek', 'Bhati', 500000, '14-06-11 09.00.00', 'Admin'),
(006, 'Vipu', 'Diwan', 200000, '14-06-11 09.00.00', 'Account'),
(007,'Satish', 'kumar', 75000, '14-01-20 09.00.00', 'Account'),
(008, 'Geetika', 'Chaohan', 90000, '14-04-11 09.00.00', 'Admin');

SELECT * FROM workers;

CREATE TABLE bonus(
	WORKER_REF_ID INT,
    BONUS_AMOUNT INT(10),
    BONNUS_DATE DATETIME,
    FOREIGN KEY (WORKER_REF_ID)
    REFERENCES workers(WORKER_ID)
    ON DELETE CASCADE
    );

INSERT INTO bonus 
	(WORKER_REF_ID, BONUS_AMOUNT, BONNUS_DATE) VALUES
		(001, 5000, '16-02-20'),
		(002, 3000, '16-06-11'),
		(003, 4000, '16-02-20'),
		(001, 4500, '16-02-20'),
		(002, 3500, '16-06-11');

CREATE TABLE Title(
		WOKRER_REF_ID INT,
        WORKER_TITLE CHAR(25),
        AFFECTED_FROM DATETIME,
        FOREIGN KEY (WOKRER_REF_ID)
        REFERENCES workers(WORKER_ID)
        ON DELETE CASCADE
);

INSERT INTO Title
	(WOKRER_REF_ID, WORKER_TITLE, AFFECTED_FROM) VALUES
	(001, 'Manager', '2016-02-20 00:00:00'),
    (002, 'Executive', '2016-06-11 00:00:00'),
    (008, 'Executive', '2016-06-11 00:00:00'),
    (005, 'Manger', '2016-06-11 00:00:00'),
    (004, 'Assist. Manager', '2016-06-11 00:00:00'),
    (007, 'Executive', '2016-06-11 00:00:00'),
    (006, 'Lead', '2016-06-11 00:00:00'),
    (003, 'Lead', '2016-06-11 00:00:00');

SELECT * FROM workers;
SELECT SALARY FROM workers;
SELECT FIRST_NAME, SALARY FROM workers;

SELECT 55 + 1;
SELECT NOW();
SELECT lcase('THAN WIN HLINE');
-- select worker whose salary is greater than 75k
SELECT * FROM workers WHERE SALARY > 75000;
SELECT * FROM workers WHERE DEPARTMENT = 'HR';

-- GET EMPLOYEE WHOSE SALARY IS 1LAKH TO 4LAKH
SELECT * FROM workers WHERE SALARY BETWEEN 100000 AND 400000;
-- reduce or statement
-- hr and admin
SELECT * FROM workers WHERE DEPARTMENT = 'HR' OR DEPARTMENT = 'Admin';
-- better way to use is IN
SELECT FIRST_NAME, DEPARTMENT FROM workers WHERE DEPARTMENT IN ('HR', "Admin");

-- get workers who are not in hr and admin
SELECT * FROM workers where DEPARTMENT NOT IN ('HR', 'Admin');
SELECT * FROM workers;
-- using wildcard
SELECT * FROM workers WHERE FIRST_NAME LIKE '%ika';
SELECT * FROM workers WHERE FIRST_NAME LIKE '%ik_';

-- sort salary by ascending order
SELECT * FROM workers ORDER BY SALARY;
-- order salary by descending order
SELECT * FROM workers ORDER BY SALARY desc;
-- how many distinct deparment org have
SELECT DISTINCT DEPARTMENT FROM workers;

-- data grouping
-- get number of employees working in different department
-- GROUP BY
SELECT DEPARTMENT FROM workers GROUP BY DEPARTMENT;
-- IF WE DONT INCLUDE AGGREGATION FUNCTION, THIS STATEMENT WILL BE TREATED AS DISTINCT
SELECT DEPARTMENT, COUNT(*) FROM workers GROUP BY DEPARTMENT;
-- avg salary per department
SELECT DEPARTMENT, AVG(SALARY) FROM workers GROUP BY DEPARTMENT;
-- MIN SALARY OF EACH DEPARTMENT
SELECT DEPARTMENT, MIN(SALARY) FROM workers GROUP BY DEPARTMENT;
-- SUM EACH GROUP SALARY
SELECT DEPARTMENT, sum(SALARY) FROM workers GROUP BY DEPARTMENT;
-- GROUP BY DEPARTMENT -> COUNT -> GET ONLY THOSE DEPT HAVING WORKER MORE THAN 2
SELECT DEPARTMENT, COUNT(SALARY) FROM workers GROUP BY DEPARTMENT HAVING COUNT(DEPARTMENT) > 2;
SELECT DISTINCT DEPARTMENT FROM workers;


CREATE DATABASE TEMP;
USE TEMP;

CREATE TABLE CUSTOMER ( 
	ID INT PRIMARY KEY,
    CNAME VARCHAR(255),
    ADDRESS VARCHAR(255),
    GENDER CHAR(2),
    CITY VARCHAR(255),
    PINCODE int
);

SELECT DISTINCT GENDER FROM CUSTOMER;

CREATE TABLE ORDER_DETAILS (
	ORDER_ID INT PRIMARY KEY,
    DELIVERY_DATE DATE,
    CUST_ID INT,
    FOREIGN KEY(CUST_ID) REFERENCES CUSTOMER(ID)
);

CREATE TABLE ACCOUNT (
	ID INT PRIMARY KEY,
    NAME VARCHAR(255) UNIQUE,
    BALANCE INT,
    CONSTRAINT ACC_BAL_CHECK CHECK( BALANCE > 10000)
);
INSERT INTO ACCOUNT(ID, NAME, BALANCE)
VALUES (02, "WINIIE", 2000000);
SELECT * FROM ACCOUNT;

DROP TABLE ACCOUNT;
CREATE TABLE ACCOUNT (
	ID INT PRIMARY KEY,
    NAME VARCHAR(255) UNIQUE,
    BALANCE INT NOT NULL DEFAULT 0
);
INSERT INTO ACCOUNT(ID, NAME)
VALUES (01, "WIN");
SELECT * FROM ACCOUNT;
-- DESCRIBE TABLE
DESC ACCOUNT;
-- ADD NEW COLUMN
ALTER TABLE ACCOUNT ADD INTEREST_RATE FLOAT NOT NULL DEFAULT 0;

-- MODIFY
ALTER TABLE ACCOUNT MODIFY INTEREST_RATE DOUBLE NOT NULL DEFAULT 0;

-- rename column 
-- rename INTEREST_RATE TO SAVING_INT
ALTER TABLE ACCOUNT CHANGE COLUMN INTEREST_RATE SAVING_INT FLOAT NOT NULL DEFAULT 0;

-- DROP COLUMN
ALTER TABLE ACCOUNT DROP COLUMN SAVING_INT;
-- RENAME THE TABLE
ALTER TABLE ACCOUNT RENAME TO ACCOUNT_DETAILS;

-- DML ( data manupulation language)
-- adding some customer datas
INSERT INTO CUSTOMER(ID, CNAME, ADDRESS, GENDER, CITY, PINCODE) VALUES
(1300, 'Than Win Hline', 'Goldighipar', 'M', "Cox's Bazar", 4700),
(1201, "WAN SHAY", "BAZARGHATA", "FM", "Khurushkuk", 4200),
(1208, "SEN SHAY", "RAMU", "FM", "Cox's Bazar", 141001),
(246, "Nelaabh Shukla", "Ashok Nagar", "M", "Jalandhar", 144003),
(301, "Rohan Arora", "Ludhiana H.O", "M", "Ludhiana", 141001);
-- another way to insert values
INSERT INTO CUSTOMER VALUES(102, "Winin Pin", "South Banasree", "FM", "Dhaka", 404040);
-- we can also insert few value if don't have all attribute's value
INSERT INTO CUSTOMER(ID, CNAME, GENDER) VALUES (109, "Mun Mun San", "M");
-- UPDATE

select * from customer;

-- update
UPDATE CUSTOMER SET ADDRESS = 'South Banasre', CITY = "DHAKA" WHERE ID = 109;
SET SQL_SAFE_UPDATES = 0;
UPDATE CUSTOMER SET CITY = 'Dhaka';
UPDATE CUSTOMER SET PINCODE = PINCODE + 2;

-- DELETE
DELETE FROM CUSTOMER WHERE ID = 1200;
-- WE CAN ALSO DELETE THE WHOLE TABLE, BUT WE NEED TO SET SQl_SAFE_UPDATES TO 0
DELETE FROM CUSTOMER;
SELECT * FROM CUSTOMER;
SELECT * FROM ORDER_DETAILS;
INSERT INTO ORDER_DETAILS(ORDER_ID, DELIVERY_DATE, CUST_ID) VALUES
(008, '2022-03-10', 100);

DELETE FROM CUSTOMER WHERE ID = 301;

-- USING ON DELETE CASCADE 
CREATE DATABASE temp;
USE TEMP;
DROP DATABASE TEMP;
CREATE TABLE CUSTOMER ( 
	ID INT PRIMARY KEY,
    CNAME VARCHAR(255),
    ADDRESS VARCHAR(255),
    GENDER CHAR(2),
    CITY VARCHAR(255),
    PINCODE int
);

CREATE TABLE ORDER_DETAILS (
	ORDER_ID INT PRIMARY KEY,
    DELIVERY_DATE DATE,
    CUST_ID INT,
    FOREIGN KEY(CUST_ID) REFERENCES CUSTOMER(ID) ON DELETE CASCADE
);
INSERT INTO CUSTOMER(ID, CNAME, ADDRESS, GENDER, CITY, PINCODE) VALUES
(1300, 'Than Win Hline', 'Goldighipar', 'M', "Cox's Bazar", 4700),
(1200, "Sen Sen Won", "Tekpara", "FM", "Khurushkuk", 4200),
(1287, "Shayam Singh", "Ludhiana H.O", "M", "Ludhiana", 141001),
(301, "Rohan Arora", "Ludhiana H.O", "M", "Ludhiana", 141001);

INSERT INTO ORDER_DETAILS(ORDER_ID, DELIVERY_DATE, CUST_ID) VALUES
(008, '2022-03-10', 301),
(001, '2022-01-02', 1300),
(002, '2022-01-02', 1300);

SELECT * FROM CUSTOMER;
SELECT * FROM ORDER_DETAILS;
DELETE FROM CUSTOMER WHERE ID = 1300;

-- USING ON DELETE SET NULL
DROP TABLE ORDER_DETAILS;
CREATE TABLE ORDER_DETAILS (
	ORDER_ID INT PRIMARY KEY,
    DELIVERY_DATE DATE,
    CUST_ID INT,
    FOREIGN KEY(CUST_ID) REFERENCES CUSTOMER(ID) ON DELETE SET NULL
);
INSERT INTO ORDER_DETAILS(ORDER_ID, DELIVERY_DATE, CUST_ID) VALUES
(007, '2022-03-10', 245);
DELETE FROM CUSTOMER WHERE ID = 301;
DELETE FROM ORDER_DETAILS WHERE ORDER_ID = 8;

SELECT * FROM CUSTOMER;
-- using replace
